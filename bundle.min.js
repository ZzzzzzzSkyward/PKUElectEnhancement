"use strict";window.pku_user_name="",window.pku_user_password="",window.lastRefreshed=new Date,window.headers={accept:"application/json, text/javascript, */*; q=0.01","Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",origin:"https://elective.pku.edu.cn","X-Requested-With":"XMLHttpRequest"},window.zzz||(window.zzz={}),zzz.value||(zzz.value={}),zzz.isInt=Number.isInteger?Number.isInteger:function(number){return number-0===Math.ceil(number)},zzz.equal=function(a,b){return a===b},zzz.equal.num=function(a,b){return a-0==b-0},zzz.equal.type=function(obj,type){return"array"===(type=type.toString().toLowerCase())||"arr"===type?obj instanceof Array:"element"===type?obj instanceof Object&&obj instanceof HTMLElement:"null"===type?null===obj:"nan"===type?isNaN(obj)&&"number"==typeof obj:"integer"===type||"int"===type?"number"==typeof obj&&zzz.isInt(obj):type===(typeof obj).toLowerCase()},zzz.toNum=function(text){for(var i=0,j=0,len=text.length,result=0,isNegative=0,isInt=1;i<len;i++)if("-"===text[i])isNegative=1;else if(text[i]<="9"&&text[i]>="0")break;if(i===len||text[i]>"9"||text[i]<"0")return NaN;for(j=i;i<len;i++)if("."===text[i])isInt=0;else if(text[i]<"0"||text[i]>"9")break;return result=isInt?parseInt(text.substr(j,i-j)):parseFloat(text.substr(j,i-j)),isNegative&&(result=0-result),result},zzz.random=function(){if(0===arguments.length)return Math.random();if(1!==arguments.length)return zzz.random.array(arguments);if(zzz.equal.type(arguments[0],"string"))return arguments[0][zzz.random.int(0,arguments[0].length-1)];if(zzz.equal.type(arguments[0],"array"))return zzz.random.array(arguments[0]);if(zzz.equal.type(arguments[0],"object")){var items=[];for(var i in arguments[0])items.push(i);return zzz.random.array(items)}},zzz.random.int=function(min_included,max_included){return max_included===min_included?min_included:max_included<min_included?zzz.random.int(max_included,min_included):Math.floor(min_included+(max_included-min_included+1)*Math.random())},zzz.random.color=function(setting){let r_min=0,r_max=255,g_min=0,g_max=255,b_min=0,b_max=255,a_min=0,a_max=100;return setting.r&&(setting.r.min&&(r_min=setting.r.min),setting.r.max&&(r_max=setting.r.max)),setting.g&&(setting.g.min&&(g_min=setting.g.min),setting.g.max&&(g_max=setting.g.max)),setting.b&&(setting.b.min&&(b_min=setting.b.min),setting.b.max&&(b_max=setting.b.max)),setting.a&&(setting.a.min&&(a_min=100*setting.a.min),setting.a.max&&(a_max=100*setting.a.max)),setting.rgba?"rgba("+zzz.random.int(r_min,r_max)+","+zzz.random.int(g_min,g_max)+","+zzz.random.int(b_min,b_max)+","+zzz.random.int(a_min,a_max)/100+")":"rgb("+zzz.random.int(r_min,r_max)+","+zzz.random.int(g_min,g_max)+","+zzz.random.int(b_min,b_max)+")"},zzz.random.string=function(len){len||(len=10);for(var str="",i=0;i<len;i++)str+=zzz.value.validCharacter[zzz.random.int(0,zzz.value.validCharacter.length-1)];return str},zzz.random.array=function(arr){return arr.length?arr[zzz.random.int(0,arr.length-1)]:null};class ztimeStructure{constructor(time){this.year=time.year||0,this.month=time.month||0,this.day=time.day||0,this.hour=time.hour||0,this.minute=time.minute||0,this.second=time.second||0,this.milisecond=time.milisecond||0,this.negative=time.negative||!1}}function init_elect(){if(tables=zzz.get("table"),tables){console.log("elect enhancement running!"),code=zzz.get("#validCode"),validImg=zzz.get.id("imgname"),getClass(),beautify(),beautifyClass(),refreshClass();try{code.focus(),autoSelect()}catch(e){}}else zzz.time.tick(init_elect,1e3)}function queryPath(regstr){return-1!==page_url.path.search(regstr)}zzz.time={convertFromDate:function(date){var result;if(date instanceof Date)return new ztimeStructure({second:date.getSeconds(),minute:date.getMinutes(),hour:date.getHours(),day:date.getDate(),month:date.getMonth()+1,year:date.getFullYear()});throw new Error("zzz.time.convertFromDate requires a Date.")},readDate:function(ztime){if(ztime instanceof ztimeStructure){var result=[0,0,0,0,0,0];return result[0]=ztime.second,result[1]=ztime.minute,result[2]=ztime.hour,result[3]=ztime.day,result[4]=ztime.month,result[5]=ztime.year,result}throw new Error("zzz.time.readDate requires a ztimeStructure.")},convertToDate:function(ztime){if(ztime instanceof ztimeStructure){var result=new Date;return result.setFullYear(ztime.year),result.setMonth(ztime.month-1),result.setDate(ztime.day),result.setHours(ztime.hour),result.setMinutes(ztime.minute),result.setSeconds(ztime.second),result}},now:function(){return this.convertFromDate(new Date)},getWeek:function(ztime){return ztime instanceof Date?ztime.getDay()||7:this.convertToDate(ztime).getDay()},getTime:function(){var result=zzz.time.now();return[result.second,result.minute,result.hour]},getDate:function(){var result=zzz.time.now();return[result.day,result.month,result.year]},test:function(func,loop){loop||(loop=1);var name=func.name?"anonymous function"+zzz.random.string(5):func.name;console.log(name+" count start"+(loop>1?" for "+loop+" times":"")),console.time(name);for(var i=0;i<loop;i++)func();console.timeEnd(name)},stringify:function(ztime){var result="",cn="chinesenumber";return result+=ztime.year?zzz.string.stringify(ztime.year,"chinese")+"年":"",result+=ztime.month?zzz.string.stringify(ztime.month,cn)+"月":"",result+=ztime.day?zzz.string.stringify(ztime.day,cn)+"日":"",result+=ztime.hour?zzz.string.stringify(ztime.hour,cn)+"时":"",result+=ztime.minute?zzz.string.stringify(ztime.minute,cn)+"分":"",result+=ztime.second?zzz.string.stringify(ztime.second,cn)+"秒":"",(result+=ztime.milisecond?zzz.string.stringify(ztime.milisecond,cn)+"毫秒":"")||(result="零秒"),result},diff:function(ztime1,ztime2){var t1=zzz.time.convertToDate(ztime1).getTime(),t2,difftime=zzz.time.convertToDate(ztime2).getTime()-t1,isNegative=difftime<0,result=zzz.time.convertFromDate(new Date(zzz.abs(difftime)));return result.negative=isNegative,result.year-=1970,result.year,result.month--,result.day--,result.hour-=8,result.minute--,result.second--,result},approximate:function(different){if(different instanceof ztimeStructure){console.log(different);var cn="chineseoral",isNegative=different.negative,mostDifferent=5,sequence=["year","month","day","hour","minute","second"],name=["年","个月","天","小时","分钟","秒"];for(let i=0;i<6;i++)if(different[sequence[i]]>0){mostDifferent=i;break}return console.log(different,mostDifferent),zzz.string.stringify(different[sequence[mostDifferent]],cn)+name[mostDifferent]+(isNegative?"前":"后")}},create:function(year,month,day,hour,minute,second,milisecond){return new ztimeStructure({year:year,month:month,day:day,hour:hour,minute:minute,second:second,milisecond:milisecond})},UTC:function(ztime){if(ztime){if(ztime instanceof ztimeStructure)ztime=zzz.time.convertToDate(ztime);else if(!(ztime instanceof Date))return}else ztime=new Date;return ztime.toUTCString()},ms:function(ztime){return ztime instanceof ztimeStructure?ztime.milisecond+1e3*ztime.second+1e3*ztime.minute*60+1e3*ztime.hour*60*60+1e3*ztime.day*60*60*24+1e3*ztime.month*60*60*24*30+1e3*ztime.year*60*60*24*30*365:0},data:{},loop:function(func,time,isLoop,isClear,name){var number=-1;if(isLoop)if(isClear){if(void 0===(number=zzz.time.data[func]))throw new Error("clearInterval unrecorded function");if(void 0===(number=number[time]))throw new Error("clearInterval unrecorded function time");clearInterval(number)}else number=setInterval(func,time),zzz.time.data[func]||(zzz.time.data[func]=[]),zzz.time.data[func][time]=number;else if(isClear){if(void 0===(number=zzz.time.data[func]))throw new Error("clearInterval unrecorded function");if(void 0===(number=number[time]))throw new Error("clearInterval unrecorded function time");clearTimeout(number)}else number=setTimeout(func,time),zzz.time.data[func]||(zzz.time.data[func]=[]),zzz.time.data[func][time]=number;return name&&(zzz.time.data[name]=number),number},clear:function(numberOrName,isLoop){var number="string"==typeof numberOrName?zzz.time.data[numberOrName]:numberOrName;if(zzz.equal.type(number,"integer"))throw new Error("zzz.time.clear receives param not of number or string");isLoop?clearInterval(number):clearTimeout(number)}},zzz.storage={init:function(){window.localStorage?(this.db=window.localStorage,this.get=function(key){return window.localStorage.getItem(key)||null},this.set=function(key,value){return window.localStorage.setItem(key,value)},this.del=function(key){return window.localStorage.removeItem(key)}):document.cookie&&(this.db=document.cookie,this.get=function(key){var cookie=document.cookie.split(";"),index;for(var i of cookie)if(index=i.indexOf("="),i.slice(0,index)===key)return i.slice(index+1);return null},this.readCookie())},add:function(item,key,value){var obj=JSON.parse(zzz.storage.get(item)||"{}");obj[key]=value;var result=JSON.stringify(obj);zzz.storage.set(item,result)},json:function(key){return JSON.parse(zzz.storage.get(key))},readCookie:function(){var cookie=document.cookie.split(";"),result=zzz.storage.cookie,index=0;for(var i of cookie)index=i.indexOf("="),result[i.slice(0,index)]=i.slice(index+1);return zzz.storage.cookie},getc:function(key){zzz.storage.readCookie();var result=zzz.storage.cookie[key];return result||null},setc:function(key,value,expire){zzz.storage.cookie[key]=value,zzz.storage.expire[key]=expire||zzz.storage.setDiffTime(),zzz.storage.refreshCookie()},delc:function(key){document.cookie=key+"="+zzz.storage.cookie[key]+";expires="+(new Date).toGMTString()+";",delete zzz.storage.cookie[key]},setDiffTime:function(diffztime){null==diffztime?diffztime=1e3*zzz.value.storage.defaultExpire:diffztime instanceof Date?diffztime=diffztime.getTime():diffztime instanceof ztimeStructure?diffztime=zzz.time.ms(diffztime):"string"==typeof diffztime&&(diffztime=zzz.toNum(diffztime));var currentTime=new Date;return currentTime.setTime(currentTime.getTime()+diffztime),currentTime.toGMTString()},setTime:function(time){return time instanceof ztimeStructure&&(time=zzz.time.convertToDate(time)),time.toGMTString()},refreshCookie:function(){var cookieText="";for(let i in zzz.storage.cookie)cookieText=i+"="+zzz.storage.cookie[i]+";",zzz.storage.expire[i]&&(cookieText+="expires="+zzz.storage.expire[i]+";"),document.cookie=cookieText},c:function(){if(0===arguments.length)return zzz.storage.readCookie();if(1===arguments.length)return zzz.storage.getc(arguments[0]);if(2===arguments.length)if(zzz.equal.type(arguments[1],"object")){for(let i in arguments[1])zzz.storage.cookie[i]=arguments[1][i];zzz.storage.refreshCookie()}else zzz.storage.setc(arguments[0],arguments[1]);else 3===arguments.length&&zzz.storage.setc(arguments[0],arguments[1],arguments[2])},cookie:{},expire:{}},zzz.browser={cookie:window.navigator.cookieEnabled,online:window.navigator.onLine,uri:window.location.href,host:window.location.hostname,path:window.location.pathname,protocol:window.location.protocol,ie:!!window.attachEvent,title:document.title,back:history.back,forward:history.forward,replace:location.replace,open:function(path,name,type){console.log(path,name,type),window.open(path,name,type)}},zzz.browser.open.inner=function(settings){if(void 0===settings)return;let src;if(zzz.equal.type(settings,"string")?src=settings:(src=settings.src,delete settings.src),src){var node=zzz.create("iframe");return settings.transparent&&(zzz.set(node,"allowtransparency","true"),zzz.set.style("backgroundColor","transparent")),node.src=src,zzz.addAttr(node,settings),node}},zzz.addAttr=function(obj,key_value_set){for(let i in key_value_set)obj[i]=key_value_set[i]},zzz.appendAttr=function(obj,key,value){var returnObject;return obj[key]=value,{func:function(key,value){this.obj[key]=value},obj:obj}},zzz.browser.collectData={screen:function(){var a=document&&document.documentElement&&document.documentElement.clientHeight||0,b=window.innerHeight||0,c=document&&document.body&&document.body.clientHeight||0;zzz.browser.screenY=Math.max(a,b,c),a=document&&document.documentElement&&document.documentElement.clientWidth,b=window.innerWidth,c=document&&document.body&&document.body.clientWidth,zzz.browser.screenX=Math.max(a,b,c)},time:function(){zzz.browser.time=zzz.time.now()},fullscreen:function(){zzz.browser.hasFullscreen=document.fullscreenEnabled},resizeObserver:function(){zzz.browser.hasResizeObserver=!!window.ResizeObserver},notification:function(){zzz.browser.hasNotification=!!window.Notification,zzz.browser.canNotify=window.Notification&&"denied"!==window.Notification.permission}},zzz.browser.init=function(){for(var i in zzz.browser.collectData)zzz.browser.collectData[i]()},zzz.get=function(name){return"."===name[0]?zzz.get.cls(name.substr(1)):"#"===name[0]?zzz.get.id(name.substr(1)):zzz.get.tag(name)},zzz.get.id=function(id){return document.getElementById(id)},zzz.get.cls=function(className){return document.getElementsByClassName(className)},zzz.get.tag=function(tagName){return document.getElementsByTagName(tagName)},zzz.get.attr=function(element,attribute){return element.getAttribute(attribute)},zzz.get.style=function(element,style){return getComputedStyle(element)[style]},zzz.create=function(tag,attributes,styles,parentNode){var element=document.createElement(tag);if(attributes){for(var i of["innerText","className","innerHTML","id","name"])attributes[i]&&(element[i]=attributes[i]);for(var i in attributes)element.setAttribute(i,attributes[i])}return styles&&zzz.anim.set(element,styles),parentNode&&parentNode.appendChild(element),element},zzz.set=function(element,attribute,value){element.setAttribute(attribute,value)},zzz.set.style=function(element,attr,value){element.style[attr]=value},zzz.incidence={index:0,init:function(){document.body.addEventListener?zzz.incidence.specificEventBinder=0:document.body.attachEvent?zzz.incidence.specificEventBinder=1:zzz.incidence.specificEventBinder=2,zzz.incidence.bind(document.body,"mousemove",zzz.incidence.mousemove)},bind:function(element,type,func,isCapture){if("scroll"===type&&(type="firefox"===zzz.browser.type?"DOMMouseScroll":"mousewheel"),"resize"===type&&zzz.browser.hasResizeObserver)return zzz.incidence.bindResizeObserver(element,func);if(0===zzz.incidence.specificEventBinder)return element.addEventListener(type,func,isCapture);if(1===zzz.incidence.specificEventBinder)return element.attachEvent("on"+type,func);if(element["on"+type]){var oldFunc=element["on"+type],newFunc=function(){oldFunc(),func()};element["on"+type]=newFunc}else element["on"+type]=func},erase:function(element,type,func){0===zzz.incidence.specificEventBinder?element.removeEventListener(type,func):1===zzz.incidence.specificEventBinder?element.removeEventListener(type,func):console.log("unable to unbind the function.")},interpret:function(event){var interpretation;return{mouse:2===event.button?"right":0===event.button?"left":void 0,client:[event.clientX,event.clientY],screen:[event.screenX,event.screenY],page:[event.pageX,event.pageY],alt:void 0!==event.altKey?event.altKey:void 0!==event.getModifierState&&event.getModifierState("Alt"),ctrl:event.ctrlKey||!1,shift:event.shiftKey||!1,capslock:void 0!==event.getModifierState&&event.getModifierState("Capslock"),type:event.type,target:event.target||event.srcElement,key:(event.key?1===event.key.length?event.key:event.key.toLowerCase():zzz.value.convertTokey(event.keyCode))||void 0,code:event.keyCode||event.which||void 0,delta:event.detail?event.detail/3:event.wheelDelta/120}},edit:{enable:function(element){zzz.set(element,"contenteditable","true")},disable:function(element){zzz.set(element,"contenteditable","false")}},waiting:!1,interval:100,mousemove:function(e){zzz.incidence.waiting||(e=zzz.incidence.interpret(e),zzz.incidence.data.target=e.target,zzz.incidence.waiting=!0,setTimeout((function(){zzz.incidence.waiting=!1}),zzz.incidence.interval))},data:{}},zzz.fetch={fetchEnabled:!1,ajaxEnabled:!1,safe_fetch:{method:"GET",mode:"same-origin",credentials:"same-origin",cache:"default",redirect:"follow"},requestStructure:function(){return{url:void 0,data:void 0,method:void 0,cors:!1,cache:void 0,header:void 0,credentials:void 0,redirect:void 0,referrer:void 0,integrity:void 0,referrerPolicy:void 0,callback:void 0,async:!0}},headStructure:{Date:"",Cookie:""},head:{create:function(settings){var head=new Headers;for(var i in settings)i=i[0].toUpperCase()+i.substr(1),head.append(i,settings.i);return head}},send:function(){throw new Error("sending fetch")},create:function(url,settings){var request=zzz.fetch.requestStructure(),promise;return request.url=url,zzz.addAttr(request,settings),zzz.fetch.fetchEnabled?zzz.fetch.fetch(request):zzz.fetch.ajax(request)},init:function(){try{(window.fetch||WorkerGlobalScope.fetch)&&(zzz.fetch.fetchEnabled=!0)}catch(e){}try{XMLHttpRequest&&(zzz.fetch.ajaxEnabled=!0)}catch(e){}zzz.fetch.fetchEnabled&&(zzz.fetch.fetch=function(settings){if(!settings.url)return!1;zzz.equal.type(settings.input,"string");var init={method:settings.method||(settings.data?"POST":"GET"),mode:settings.cors?"cors":"same-origin",body:settings.data||void 0,credentials:settings.credentials||"include",cache:settings.cache||"reload",redirect:settings.redirect||void 0,referrer:settings.referrer||void 0,integrity:settings.integrity||void 0,referrerPolicy:settings.referrerPolicy||void 0},promise=zzz.fetch.send(settings.url,init);return settings.callback?promise.then(settings.callback):promise}),zzz.fetch.ajaxEnabled&&(zzz.fetch.ajax=function(settings){if(!settings.url)return!1;var xhr=new XMLHttpRequest;if(xhr.open(settings.method||"GET",settings.url,void 0===settings.async||settings.async),settings.callback&&(xhr.onreadystatechange=settings.callback),settings.timeout&&(xhr.timeout=settings.timeout),settings.header)for(let i in settings.header)xhr.setRequestHeader(i,settings.header[i]);return settings.ontimeout&&(xhr.ontimeout=settings.ontimeout),xhr.send(settings.data),xhr})},judge:function(response){return console.log(response),response.complete?"success":void 0!==response.ok?response.ok?"success":"fail":4===response.readyState?200===response.status?"pending":"fail":"success"},cors:function(src,type,parent,callback){parent||(parent=document.body),type||(type="script");var node=zzz.create(type,{src:src},{display:"none"});if(callback){let wrapper=function(){callback({node:node,ok:!0})},wrapper_fail=function(){callback({node:node,ok:!1})},wrapper_change=function(){callback({node:node,readyState:node.readyState})};zzz.incidence.bind(node,"load",wrapper),zzz.incidence.bind(node,"readystatechange",wrapper_change),zzz.incidence.bind(node,"error",wrapper_fail)}return parent.appendChild(node),node},get:function(src,callback,parent){parent||(parent=document.body);var node=zzz.create("script",{src:src},{display:"none"}),uniqueText=zzz.random.string(30);return window[uniqueText]=function(response){callback(response),delete window[uniqueText]},zzz.set(node,"src",zzz.path.merge(src,{callback:uniqueText})),parent.appendChild(node),node},css:function(src,parent){var node=zzz.create("link",{href:src,rel:"stylesheet",type:"text/css"});return parent||(parent=document.body),parent.appendChild(node),node},font:function(name,src){var node=zzz.create("style");node.innerText="@font-face{font-family:'"+name+"';src:url('"+src+"')}",document.body.appendChild(node)},js:function(src,parent){parent||(parent=document.body);var node=zzz.create("script",{src:src});parent.appendChild(node)}},zzz.path={split:function(url){var protocol_index,protocol,component_index,component=[],port_index,port,host,path="/",host_index,domain,subdomain;protocol=(protocol_index=url.match("://"))?url.substr(0,protocol_index.index+1):"",protocol_index&&(url=url.substr(protocol_index.index+3)),"/"===url[0]&&(url=url.substr(1)),(component_index=url.match(/\?/))&&(component=url.substr(component_index.index+1).split("&"),url=url.slice(0,component_index.index)),(port_index=url.match(/:[0-9]{1,5}/))?(port=port_index[0].substr(1),host=url.slice(0,port_index.index),path=url.slice(port_index.index+port.length+1)||"/"):(port="",-1!==(host_index=url.indexOf("/"))?(host=url.slice(0,host_index),path=url.slice(host_index)):host=url);var domains=host.split(".");domain=domains?domains[domains.length-1]:"",zzz.equal.type(zzz.toNum(domain),"NaN")||(domain=host),"."===(subdomain=host.replace(domain,""))[subdomain.length-1]&&(subdomain=subdomain.substr(0,subdomain.length-1));var result={protocol:protocol,0:protocol,path:zzz.code.path.decode(path),host:host,1:host,domain:domain,subdomain:subdomain,port:port,2:port,component:{},3:{}};"file:"===result.protocol&&(result.domain="",result.subdomain="",result[1]=result[2]="");for(let i of component){if(!i)continue;for(var key=0;"="!==i[key]&&key<i.length;key++);let name=zzz.code.path.decode(i.substr(0,key)),value=zzz.code.path.decode(i.substr(key+1));result.component[name]=value,result[3][name]=value}return result},merge:function(){var result="";if(1===arguments.length){var short=arguments[0];if(result+=short.protocol?short.protocol+"//":"","file:"===short.protocol&&(result+="/"),result+=short.host||"",result+=short.port?":"+short.port:"",short.path&&(result+=short.path),short.port||short.path||"/"===result[result.length-1]||(result+="/"),result=zzz.code.uri.encode(result),short.component){result+="?";let items=[];for(var i in short.component)i&&items.push(zzz.code.path.encode(i)+"="+zzz.code.path.encode(short.component[i]));result+=items.join("&")}return"?"===result[result.length-1]&&(result=result.substr(0,result.length-1)),result}if(2===arguments.length&&zzz.equal.type(arguments[0],"string")&&zzz.equal.type(arguments[1],"object")){let origin=zzz.path.split(arguments[0]);for(var i in arguments[1])origin.component[i]=arguments[1][i];return zzz.path.merge(origin)}console.log("invalid input for zzz.path.merge, the arguments are",arguments)},deleteEnd:function(url){return url.replace(/\/$/,"")},abs:function(url,base){base||(base="");var node=zzz.create("a");zzz.set(node,"href",base+url);var result=node.href;return node=null,zzz.path.deleteEnd(result)}},zzz.run={init:function(){document.run||(document.run=[]);var urlParts=zzz.path.split(zzz.browser.uri);for(let i of document.run)try{if("equal"===i.method){if(i.string!==zzz.browser.uri)continue}else if("match"===i.method){if(!zzz.browser.uri.match(i.string))continue}else if(!("function"!==i.method||i.function&&i.function(urlParts)))continue;i.run()}catch(e){console.log("something in zzz.run.init wrong!")}}},zzz.code={uri:{encode:function(text){return window.encodeURI(text)},decode:function(uri){return window.decodeURI(uri)}},path:{encode:function(text){return window.encodeURIComponent(text)},decode:function(component){return window.decodeURIComponent(component)}}},zzz.value.keyCode={1:"leftbutton",2:"rightbutton",4:"middlebutton",8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"blank",33:"pageup",34:"pagedown",35:"end",36:"home",37:"leftarrow",38:"uparrow",39:"rightarrow",40:"downarrow",44:"printscreen",45:"insert",46:"delete",91:"winl",92:"winr",106:"*num",107:"+num",109:"-num",110:".num",111:"/num",144:"numlock",145:"scrolllock",160:" ",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",222:"'"},zzz.value.convertTokey=function(code){return code>=48&&code<=57?code-48+"":code>=65&&code<=90?String.fromCharCode(code+32):code>=96&&code<=105?code-96+"num":code>=112&&code<=123?"F"+(code-111):code in zzz.value.keyCode?zzz.value.keyCode[code]:String.fromCharCode(code)},zzz.anim={set:function(element,style){for(let i in style)element.style[i]=style[i]}},zzz.init=function(){zzz.storage.init(),zzz.incidence.init(),zzz.browser.init(),zzz.fetch.init(),zzz.inited=!0;try{window.zzzloaded&&window.zzzloaded(),document.zzzloaded&&document.zzzloaded()}catch(e){}},zzz.init(),zzz.storage.json("desired")||zzz.storage.set("desired","[]"),window.desiredClass=zzz.storage.json("desired"),window.hideIt=function(e){return zzz.set.style(e,"display","none"),hideIt},window.showIt=function(e){return zzz.set.style(e,"display","table-row"),showIt},window.opacityIt=function(e){return zzz.anim.act(e,{opacity:(add_opacity?"+":"-")+"0.3"}),opacityIt},window.nxt=function(e){return e.nextElementSibling},window.code=null,window.tables=null,window.validImg=null,window.classInfo=[],window.tableTitle=[],window.toptable=zzz.create("div",{id:"toptable"},{top:(zzz.storage.get("y")||"0")+"px",left:(zzz.storage.get("x")||"0")+"px"},document.body),window.msg=zzz.create("p",{innerText:"这里是信息"},{color:"red",fontWeight:"bold",transition:"all 0.1s linear"}),window.add_opacity=!1,window.abbr=function(name){var origin="信息 地球 国际 环境 生命 城市 中国语言 新闻".split(" "),abbriv="信科 地空 国关 环科 生科 城环 汉语         新传".split(" "),origin2="化学 物理 马克思 心理 艺术 经济 外国 法学".split(" ");for(var i in origin)if(0==name.search(origin[i]))return abbriv[i];for(var i in origin2)if(0==name.search(origin2[i]))return name[0]+"院";return name.substr(0,2)},window.goToClass=function(e){for(;"tr"!==e.tagName.toLowerCase();)e=e.parentElement;return e},window.getClass=function(){var table;for(table of tables)if(table.firstElementChild&&table.firstElementChild.firstElementChild&&"datagrid-header"===table.firstElementChild.firstElementChild.className)break;if(!table)return;let classLine=table.firstElementChild.firstElementChild;window.shouldMove&&classLine.insertBefore(classLine.lastElementChild,classLine.firstElementChild);for(let i of classLine.children){let text=i.innerText;tableTitle.push(text)}classLine=nxt(classLine);let index=0;for(;classLine&&"datagrid-footer"!==classLine.className;){let i=classLine.firstElementChild,info={element:classLine,text:[],id:i.firstElementChild.href?i.firstElementChild.href.match(/BZ[0-9_]+$/)[0]:0},flag=!0;for(;flag&&i;){let text=i.innerText;if(info.text.push(text),-1!==text.search("补选|刷新|预选|取消|删除"))info.button=i.firstElementChild,"补选"===text&&desiredClass.find((function(id){return id===info.id&&(sendMessage(info.text[0]+"可以冲"),i.style.backgroundColor="red",!0)})),window.shouldMove&&classLine.insertBefore(i,classLine.firstElementChild),flag=!1;else if(text.match("[0-9]{1,3} / [0-9]{1,3}")){let allocation=zzz.toNum(text.match("[0-9]+")[0]),amount=zzz.toNum(text.match(/[ ][0-9]+/)[0]);amount===2*allocation&&(amount=allocation),info.limit=allocation,info.current=amount,i.style.width="7em",i.style.boxShadow="currentColor 0 0 3px 0",zzz.incidence.bind(i,"click",(function(e){e=zzz.incidence.interpret(e);var element=goToClass(e.target).children[1].firstElementChild,id=element.href.match(/BZ[0-9_]+$/)[0],name=element.innerText;console.log(id);let included=desiredClass.find((function(x){return x===id}));confirm((included?"不要":"想要")+name+"么")&&(included?delClass(id):addClass(id))}))}else if(text.match(/教授|研究员|讲师|助理/)){let t=text.replace(/[(][^)]+[)]/g,"");i.innerText=t}else text.match(/(学院|系|部)$/)&&(i.innerText=window.abbr(text));i=nxt(i)}classInfo[index]=info,index++,classLine=nxt(classLine)}},window.queryDesired=function(desired,undesired){undesired||(undesired=function(){});for(let cls of classInfo){let flag=!0;for(let i of desiredClass)if(cls.id===i){flag=!1;break}flag?undesired(cls):desired(cls)}},window.elect=function(arr){arr[arr.length-1]<arr[arr.length-2]&&send(j[0])},window.fresh=function(){location.reload(!0)},window.confirmSelect=function(xh,stuName,courseName,classNo,onlySupp,index,seqNo,freshFlag,limitedNbr){var refreshUrl2;if(freshFlag)return refreshLimit(xh,stuName,courseName,classNo,onlySupp,index,seqNo,limitedNbr,"return confirmSelect('"+xh+"','"+stuName+"','"+courseName+"','"+classNo+"',"+onlySupp+",'"+index+"','"+seqNo+"',false,'"+limitedNbr+"');"),!1;if(onlySupp)return sendMessage("现在不可以退课的说"),!0;if(!window.validate(xh))return!1;var no="";""!=classNo&&(no="班号:"+classNo+"。");var spmsg="";("yjkc20140500014647"==seqNo&&"03"==classNo||"yjkc20140500014647"==seqNo&&"04"==classNo||"yjkc20210500039424"==seqNo&&"04"==classNo||"yjkc20210800040364"==seqNo||"yjkc20210800040366"==seqNo)&&(spmsg="该课程上课地点在昌平吉利校区。");var msg=stuName+"同学,您确定要选《"+courseName+"》这门课程吗？"+no+spmsg+"\n";return window.confirm(msg)},window.confirmSelectUnder=function(xh,stuName,courseName,classNo,onlySupp,index,seqNo,freshFlag,limitedNbr){if(freshFlag){var refreshUrl2="return confirmSelectUnder('"+xh+"','"+stuName+"','"+courseName+"','"+classNo+"',"+onlySupp+",'"+index+"','"+seqNo+"',false,'"+limitedNbr+"');";return window.refreshLimit(xh,stuName,courseName,classNo,onlySupp,index,seqNo,limitedNbr,refreshUrl2),!1}return window.validate(xh)},window.refreshLimit=function(xh,stuName,courseName,classNo,onlySupp,index,seqNo,limitedNbr,refreshUrl2){var diff;if(clearMsg(),(new Date-lastRefreshed)/1e3<2)sendMessage("操作太快了");else{var limitedNum=parseInt(limitedNbr),xhr=zzz.fetch.ajax({url:"/elective2008/edu/pku/stu/elective/controller/supplement/refreshLimit.do",method:"POST",data:"index="+index+"&seq="+seqNo+"&xh="+xh,async:!1,header:headers});try{var data,newNum=JSON.parse(xhr.responseText).electedNum;if("NA"==newNum)sendMessage("刷新频繁！");else if("NB"==newNum)sendMessage("刷新异常！");else if(zzz.get.id("electedNum"+index+index).innerHTML=limitedNum+" / "+newNum,parseInt(newNum)<limitedNum){var aTag=zzz.get.id("#refreshLimit"+index+index);aTag.innerText="补选",zzz.set(aTag,"onclick",refreshUrl2)}else sendMessage("没有空余名额！")}catch(e){sendMessage("网络不行的样子")}}},window.getv=function(element){return element.value?element.value:element.innerText?element.innerText:element.innerHTML},window.sendMessage=function(text){msg.innerHTML=text,zzz.anim.set(msg,{color:zzz.random.color({r:{max:200},g:{max:200},b:{max:200},a:{min:.5}})}),msg.scrollIntoView(!0)},window.validate=function(xh){var valid=!1,cd=getv(code);if(4!==cd.length)return sendMessage("验证码???"),!1;var xhr=zzz.fetch.ajax({url:"/elective2008/edu/pku/stu/elective/controller/supplement/validate.do",method:"POST",data:"xh="+xh+"&validCode="+cd,header:headers,async:!1});try{var response;(valid=2==JSON.parse(xhr.responseText).valid)||sendMessage("错了")}catch(e){sendMessage("断网了")}return valid},window.changeValid=function(){validImg.src="/elective2008/DrawServlet?Rand="+1e4*Math.random()},window.addClass=function(id){desiredClass.push(id),refreshStorage(),refreshClass()},window.delClass=function(id){let newClass=[];for(let i of desiredClass)id!==i&&newClass.push(i);desiredClass=newClass,refreshStorage(),refreshClass()},window.refreshStorage=function(){let a=new Set(desiredClass);desiredClass=[];for(let i of a)desiredClass.push(i);zzz.storage.set("desired",JSON.stringify(desiredClass))},window.refreshClass=function(){queryDesired((function(cls){zzz.set.style(cls.element,"backgroundColor","#ffb14c")}))},window.moveIt=function(e,element){element||(element=toptable),e=zzz.incidence.interpret(e),window.positionX=e.client[0],window.positionY=e.client[1],zzz.anim.set(element,{left:positionX+"px",top:positionY+"px"})},window.autoSelect=function(){zzz.incidence.bind(code,"change",(function(){classInfo.find((function(cls){if(cls.limit>cls.current&&desiredClass.find((function(id){return id===cls.id})))return cls.button.click(),!0}))}))},window.relogin=function(){var original_url="https://iaaa.pku.edu.cn/iaaa/oauth.jsp?appID=syllabus&appName=%E5%AD%A6%E7%94%9F%E9%80%89%E8%AF%BE%E7%B3%BB%E7%BB%9F&redirectUrl=http://elective.pku.edu.cn:80/elective2008/ssoLogin.do";if(window.pku_user_name&&window.pku_user_password){var token_url="https://iaaa.pku.edu.cn/iaaa/oauthlogin.do",elect_login_url="http://elective.pku.edu.cn:80/elective2008/ssoLogin.do",res=zzz.fetch.ajax({url:token_url,method:"POST",data:"appid=syllabus&userName="+window.pku_user_name+"&password="+window.pku_user_password+"&randCode=&smsCode=&otpCode=&redirUrl="+zzz.code.path.encode(elect_login_url),header:{Host:"iaaa.pku.edu.cn",Origin:"https://iaaa.pku.edu.cn",Referer:"https://iaaa.pku.edu.cn/iaaa/oauth.jsp?appID=syllabus&appName=%E5%AD%A6%E7%94%9F%E9%80%89%E8%AF%BE%E7%B3%BB%E7%BB%9F&redirectUrl=http://elective.pku.edu.cn:80/elective2008/ssoLogin.do","Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},async:!1}).responseText,js=JSON.parse(res);if(console.log("fetch=",js),js.token){var jump_url=elect_login_url+"?_rand="+zzz.random()+"&token="+js.token;location.replace(jump_url)}}else location.replace(original_url)},window.beautify=function(){var css="\n    th,td,a,span,font{\n    font-size:20px!important;\n    }\n    #toptable{\n        position: fixed;\n        display: flex;\n        font-size: 20px;\n        background-color: hsla(0,0%,100%,0.34);\n        z-index: 9999;\n        justify-content: center;\n        align-items: first baseline;\n        flex-direction: column;\n        width:6em;\n        overflow:visible;\n    }\n    #toptable p{\n    font-size:1em;\n    min-width:20px;\n    max-width:6em;\n    box-shadow:0 0 3px 0;\n    transition:all 1s linear;\n    padding:5px;\n    background-color:rgba(240,250,250,0.8);\n    width:100%;\n    text-align:center;\n    margin:0;\n    }\n    #toptable p:hover{\n    background-color:rgba(240,50,50,0.8);\n    }\n    .datagrid{\n        padding:0 !important;\n        white-space:pre-line;\n    }\n    .datagrid span {\n    display: block;\n    overflow: hidden;\n    width: auto !important;\n    max-height: 10em;\n    line-height: 1em;\n    word-wrap: anywhere;\n    word-break: break-all;\n    }\n    .datagrid-all{\n    color:green;\n    }\n    ";zzz.create("style",{innerText:css},null,document.body);for(let j of document.images)if("/elective2008/resources/images/attention.jpg"===j.src){j.src="",hideIt(j.parentElement);break}zzz.set(zzz.get("td")[0],"background","");var addButton=function(text,func){var e=zzz.create("p",{innerHTML:text},{},toptable);return zzz.incidence.bind(e,"click",func),e};window.isHidden=!1;var hide=function(){isHidden?queryDesired((function(){}),(function(cls){showIt(cls.element)})):queryDesired((function(){}),(function(cls){hideIt(cls.element)})),isHidden=!isHidden,hideButton.innerText=isHidden?"显示课程":"隐藏课程",zzz.storage.set("willHide",isHidden)};window.hideButton=addButton("隐藏课程",hide);var impact=function(){var b=!zzz.storage.json("impact");for(var i of document.querySelectorAll(".datagrid span"))zzz.set.style(i,"maxHeight",b?"1em":"10em");zzz.storage.set("impact",b),window.impactButton.innerText=b?"紧凑":"展开"};window.impactButton=addButton("紧凑模式",impact),window.refreshButton=addButton("刷新",fresh),addButton("移动",(function(){zzz.incidence.bind(document.body,"mousemove",moveIt,!1),zzz.time.loop((function(){zzz.incidence.erase(document.body,"mousemove",moveIt,!1),zzz.storage.set("x",positionX),zzz.storage.set("y",positionY)}),5e3)})),addButton("重登",(function(){relogin()})),toptable.appendChild(msg),zzz.storage.json("impact")&&impact(),zzz.storage.json("willHide")&&hide()},window.beautifyClass=function(){validImg&&(toptable.appendChild(validImg),toptable.appendChild(code),zzz.anim.set(code,{fontSize:"2em",width:"6em",height:"auto",backgroundColor:"rgba(255,255,255,0.5)"}),zzz.anim.set(validImg,{width:"400px",filter:"contrast(2)",opacity:.8}),zzz.incidence.bind(validImg,"click",changeValid));var taiChiFlag=!0,tongZhiFlag=!0;for(let i of zzz.get.tag("td"))taiChiFlag&&-1!==i.innerText.search("您还未修太极拳")?(hideIt(i.parentElement),taiChiFlag=!1):tongZhiFlag&&-1!==i.innerText.search("通知：")&&(hideIt(i.parentElement),tongZhiFlag=!1)},window.lazy={funcs:{},time:2e3,register:function(name,func){if(!this.funcs[name]){this.funcs[name]={};var t=this.funcs[name];t.func=func,t.name=name}t.time=new Date,this.tick(name)},tick:function(name){setTimeout((function(){lazy.run(name)}),2e3)},run:function(name){if(this.funcs[name]){var diff;if(new Date-this.funcs[name].time<lazy.time)return;this.funcs[name].func(),this.funcs[name].time=new Date}}},window.autoSubmit=function(){beautify();var form=zzz.get.id("qyForm");if(form)for(let i of form.getElementsByTagName("input"))"radio"==i.type?zzz.incidence.bind(i,"click",(function(){lazy.register(i.id,(function(){zzz.get.id("b_query").click()}))})):"text"==i.type&&zzz.incidence.bind(i,"change",(function(){lazy.register(i.id,(function(){zzz.get.id("b_query").click()}))}))},window.page_url=zzz.path.split(zzz.browser.uri),zzz.get.tag("strong").length&&"提示:"===zzz.get.tag("strong")[0].innerText&&relogin(),queryPath("supplement")&&(window.shouldMove=!0),queryPath("electiveWork|electivePlan|supplement")?init_elect():queryPath("CourseQueryController|getCurriculmByForm")?autoSubmit():"/iaaa/oauth.jsp"===page_url.path||"/elective2008/logout.do"===page_url.path?zzz.time.loop((function(){window.pku_user_name&&(zzz.get.id("user_name").value=window.pku_user_name),window.pku_user_password&&(zzz.get.id("password").value=window.pku_user_password),getv(zzz.get.id("user_name"))&&getv(zzz.get.id("password"))&&window.oauthLogon()}),1e3):(console.log("not usable"),beautify());